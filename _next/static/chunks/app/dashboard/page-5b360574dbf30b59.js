(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{8083:function(e,s,t){Promise.resolve().then(t.bind(t,9922))},9922:function(e,s,t){"use strict";let a,l;t.r(s),t.d(s,{default:function(){return E},dynamicParams:function(){return C}});var r=t(7437),n=t(2265),c=t(9763);let i=(0,c.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var d=t(2735);let x=(0,c.Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var m=t(6070),o=t(492),h=t(1994);let u=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,j=h.W;var y=t(4508);let g=(a="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",l={variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}},e=>{var s;if((null==l?void 0:l.variants)==null)return j(a,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:t,defaultVariants:r}=l,n=Object.keys(t).map(s=>{let a=null==e?void 0:e[s],l=null==r?void 0:r[s];if(null===a)return null;let n=u(a)||u(l);return t[s][n]}),c=e&&Object.entries(e).reduce((e,s)=>{let[t,a]=s;return void 0===a||(e[t]=a),e},{});return j(a,n,null==l?void 0:null===(s=l.compoundVariants)||void 0===s?void 0:s.reduce((e,s)=>{let{class:t,className:a,...l}=s;return Object.entries(l).every(e=>{let[s,t]=e;return Array.isArray(t)?t.includes({...r,...c}[s]):({...r,...c})[s]===t})?[...e,t,a]:e},[]),null==e?void 0:e.class,null==e?void 0:e.className)});function f(e){let{className:s,variant:t,...a}=e;return(0,r.jsx)("div",{className:(0,y.cn)(g({variant:t}),s),...a})}var N=t(4401);let v=(0,c.Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),p=(0,c.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),b=(0,c.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),k=(0,c.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);function w(){let[e,s]=(0,n.useState)({}),[t,a]=(0,n.useState)(!0),[l,c]=(0,n.useState)(null);if((0,n.useEffect)(()=>{(async function(){try{a(!0);let e=await fetch("/data/run-records.json");if(!e.ok)throw Error("无法加载运行记录");let t=await e.json();s(t)}catch(e){c(e instanceof Error?e.message:"加载失败")}finally{a(!1)}})()},[]),t)return(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(N.Z,{className:"h-5 w-5"}),"数据拉取记录"]})}),(0,r.jsx)(m.aY,{children:(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})})})]});if(l)return(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(N.Z,{className:"h-5 w-5"}),"数据拉取记录"]})}),(0,r.jsx)(m.aY,{children:(0,r.jsxs)("div",{className:"flex items-center justify-center py-8 text-red-500",children:[(0,r.jsx)(v,{className:"h-5 w-5 mr-2"}),l]})})]});let i=Object.keys(e);return 0===i.length?(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(N.Z,{className:"h-5 w-5"}),"数据拉取记录"]})}),(0,r.jsx)(m.aY,{children:(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:"暂无运行记录"})})]}):(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsxs)(m.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(N.Z,{className:"h-5 w-5"}),"数据拉取记录"]})}),(0,r.jsx)(m.aY,{children:(0,r.jsx)("div",{className:"space-y-4",children:i.map(s=>{let t=e[s],a=t.filter(e=>{let s=new Date().toISOString().split("T")[0];return e.date===s});return(0,r.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("h3",{className:"font-semibold text-lg",children:{first:"第一阶段",second:"第二阶段"}[s]||s}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(f,{variant:"outline",children:["今日: ",a.length," 次"]}),(0,r.jsxs)(f,{variant:"outline",children:["总计: ",t.length," 次"]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[t.slice(0,5).map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border ".concat(e.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[e.success?(0,r.jsx)(p,{className:"h-5 w-5 text-green-500"}):(0,r.jsx)(v,{className:"h-5 w-5 text-red-500"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(b,{className:"h-4 w-4 text-gray-500"}),(0,r.jsx)("span",{className:"font-medium",children:new Date(e.date).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"})}),(0,r.jsx)(k,{className:"h-4 w-4 text-gray-500"}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:new Date(e.time).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})})]}),!e.success&&e.error&&(0,r.jsxs)("div",{className:"text-sm text-red-600 mt-1",children:["错误: ",e.error]})]})]}),(0,r.jsx)(f,{variant:e.success?"default":"destructive",children:e.success?"成功":"失败"})]},e.timestamp)),t.length>5&&(0,r.jsxs)("div",{className:"text-center text-sm text-gray-500 py-2",children:["还有 ",t.length-5," 条记录..."]})]})]},s)})})})]})}var Z=t(9116);let C=!1,D={AM50:"年度男艺人",AM51:"年度女艺人",AM52:"年度男团",AM53:"年度女团",AM54:"最具人气新人-男",AM55:"最具人气新人-女",PR70:"年度歌曲",PR71:"年度专辑",PR72:"年度合作",PR73:"年度音乐视频",PR74:"JMA中国最具影响力华语流行男艺人"};function O(e){return e.startsWith("PR")}function E(){var e;let[s,t]=(0,n.useState)(!0),[a,l]=(0,n.useState)(null),[c,h]=(0,n.useState)([]),[u,j]=(0,n.useState)("first"),[g,f]=(0,n.useState)(""),[N,v]=(0,n.useState)("");(0,n.useEffect)(()=>{!async function(){t(!0);try{let e=await (0,Z._h)(u);l(e)}catch(e){console.error("加载数据失败:",e)}finally{t(!1)}}()},[u]);let p=(0,n.useMemo)(()=>a?Object.keys(a.categories):[],[a]);(0,n.useEffect)(()=>{a&&p.length>0&&!g&&f(p[0])},[a,p,g]);let b=(0,n.useMemo)(()=>a&&g&&a.categories[g]||[],[a,g]);if((0,n.useEffect)(()=>{let e=b;if(N.trim()){let s=N.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(s)||e.englishName&&e.englishName.toLowerCase().includes(s)||e.nameOfWork&&e.nameOfWork.toLowerCase().includes(s))}h(e)},[b,N]),s)return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsx)(o.Wo,{title:"正在加载榜单数据...",description:"请稍候"}),(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)(o.Jr,{columns:6,rows:10})})]})});if(!a||!g)return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsx)(m.Zb,{children:(0,r.jsx)(m.aY,{className:"py-12 text-center",children:(0,r.jsx)("p",{className:"text-gray-500",children:"暂无数据"})})})})});let k=D[g]||g,C=O(g);return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:[k," - Top排行榜"]}),(0,r.jsxs)("p",{className:"mt-2 text-gray-600",children:["数据更新时间: ",(0,y.p6)(a.snapshot_date)," | 阶段: ","first"===u?"第一阶段":"第二阶段"," | 当前分类候选",C?"作品":"人",": ",b.length,C?"个":"名"]})]}),(0,r.jsx)(m.Zb,{className:"mb-6",children:(0,r.jsx)(m.aY,{className:"py-4",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>j("first"),className:(0,y.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","first"===u?"bg-primary-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"第一阶段"}),(0,r.jsx)("button",{onClick:()=>j("second"),className:(0,y.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","second"===u?"bg-primary-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"第二阶段"})]}),(0,r.jsx)("select",{value:g,onChange:e=>f(e.target.value),className:"select-trigger w-64",children:p.map(e=>(0,r.jsx)("option",{value:e,children:D[e]||e},e))}),(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:C?"搜索艺人名或作品名...":"搜索艺人名...",value:N,onChange:e=>v(e.target.value),className:"search-input pl-10"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:()=>{if(!c.length)return;let e=D[g]||g,s=O(g),t=new Blob([[(s?["排名","艺人名","英文名","作品名","编号","当前票数","昨日排名","排名变化"]:["排名","艺人名","英文名","编号","当前票数","昨日排名","排名变化"]).join(","),...c.map(e=>{let t=[e.rankToday,e.name,e.englishName||"-"];return s&&t.push(e.nameOfWork||"-"),t.push(e.talentNumber||"-",e.currentVotes,e.rankYesterday||"-",e.rankDelta||0),t.join(",")})].join("\n")],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),l=URL.createObjectURL(t);a.setAttribute("href",l),a.setAttribute("download","".concat(e,"_Top排行榜_").concat((0,y.p6)(new Date),".csv")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},className:"btn-secondary flex items-center gap-2",disabled:!c.length,children:[(0,r.jsx)(d.Z,{className:"w-4 h-4"}),"导出CSV"]}),(0,r.jsxs)("button",{onClick:()=>window.location.reload(),className:"btn-secondary flex items-center gap-2",children:[(0,r.jsx)(x,{className:"w-4 h-4"}),"刷新数据"]})]})]})})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,r.jsx)(m.Zb,{children:(0,r.jsx)(m.aY,{className:"py-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:(0,y.uf)(b.length)}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["候选",C?"作品":"人","总数"]})]})})}),(0,r.jsx)(m.Zb,{children:(0,r.jsx)(m.aY,{className:"py-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:(0,y.uf)(c.length)}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"当前显示"})]})})}),(0,r.jsx)(m.Zb,{children:(0,r.jsx)(m.aY,{className:"py-6",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:(0,y.uf)(b.reduce((e,s)=>e+s.currentVotes,0))}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"分类总票数"})]})})}),(0,r.jsx)(m.Zb,{children:(0,r.jsx)(m.aY,{className:"py-6",children:(0,r.jsx)("div",{className:"flex justify-center",children:c.length>0&&(null===(e=c[0])||void 0===e?void 0:e.rankToday)===1?(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[c[0].imageUrl&&(0,r.jsx)("img",{src:c[0].imageUrl,alt:c[0].name,className:"w-12 h-12 rounded-full object-cover border-2 border-yellow-400 shadow-lg flex-shrink-0",onError:e=>{e.target.style.display="none"}}),(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("div",{className:"text-sm font-bold text-yellow-600",children:"\uD83E\uDD47 第一名"}),(0,r.jsx)("div",{className:"font-medium text-gray-900 text-sm",children:c[0].name}),C&&c[0].nameOfWork&&(0,r.jsxs)("div",{className:"text-xs text-gray-600",children:["《",c[0].nameOfWork,"》"]}),(0,r.jsxs)("div",{className:"text-xs text-green-600 font-medium",children:[(0,y.uf)(c[0].currentVotes)," 票"]})]})]}):(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-400",children:"-"}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"暂无第一名"})]})})})})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)(w,{})}),(0,r.jsxs)(m.Zb,{children:[(0,r.jsx)(m.Ol,{children:(0,r.jsxs)(m.ll,{children:[k," - Top ",b.length," 完整排行榜"]})}),(0,r.jsx)(m.aY,{className:"p-0",children:(0,r.jsx)("div",{className:"table-container max-h-[600px] overflow-y-auto scrollbar-thin",children:(0,r.jsxs)("table",{className:"table",children:[(0,r.jsx)("thead",{className:"table-header sticky top-0 bg-white",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"table-head",children:"排名"}),(0,r.jsx)("th",{className:"table-head",children:C?"创作者/艺人":"艺人"}),C&&(0,r.jsx)("th",{className:"table-head",children:"作品名称"}),(0,r.jsx)("th",{className:"table-head",children:"编号"}),(0,r.jsx)("th",{className:"table-head",children:"当前票数"}),(0,r.jsx)("th",{className:"table-head",children:"昨日排名"}),(0,r.jsx)("th",{className:"table-head",children:"排名变化"})]})}),(0,r.jsx)("tbody",{className:"table-body",children:c.map(e=>{let s=(0,y.JQ)(e.rankDelta);return(0,r.jsxs)("tr",{className:"table-row",children:[(0,r.jsx)("td",{className:"table-cell",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("span",{className:(0,y.cn)("font-medium text-lg",e.rankToday<=3&&"text-yellow-600 font-bold",e.rankToday<=10&&e.rankToday>3&&"text-blue-600 font-semibold"),children:["#",e.rankToday]}),e.rankToday<=3&&(0,r.jsx)("span",{className:"ml-2 text-yellow-500",children:1===e.rankToday?"\uD83E\uDD47":2===e.rankToday?"\uD83E\uDD48":"\uD83E\uDD49"})]})}),(0,r.jsx)("td",{className:"table-cell",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[e.imageUrl&&(0,r.jsx)("img",{src:e.imageUrl,alt:e.name,className:"w-12 h-12 rounded-full object-cover border-2 border-gray-200",onError:e=>{e.target.style.display="none"}}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),e.englishName&&e.englishName!==e.name&&(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.englishName})]})]})}),C&&(0,r.jsx)("td",{className:"table-cell",children:(0,r.jsx)("div",{className:"font-medium text-gray-900",children:e.nameOfWork||"-"})}),(0,r.jsx)("td",{className:"table-cell",children:(0,r.jsx)("span",{className:"text-xs text-gray-500 font-mono",children:e.talentNumber})}),(0,r.jsx)("td",{className:"table-cell",children:(0,r.jsx)("div",{className:"font-medium text-lg",children:(0,y.uf)(e.currentVotes)})}),(0,r.jsx)("td",{className:"table-cell",children:e.rankYesterday?"#".concat(e.rankYesterday):"-"}),(0,r.jsx)("td",{className:"table-cell",children:(0,r.jsx)("span",{className:(0,y.cn)("rank-change",s.className),children:s.text})})]},e.id)})})]})})})]})]})})}},4401:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]])},2735:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});let a=(0,t(9763).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])}},function(e){e.O(0,[368,86,971,117,744],function(){return e(e.s=8083)}),_N_E=e.O()}]);