(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[479],{2769:function(e,t,a){Promise.resolve().then(a.bind(a,7843))},7843:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x},dynamicParams:function(){return m}});var n=a(7437),s=a(2265),r=a(2735);let l=(0,a(9763).Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var o=a(6070),i=a(492),c=a(4508),d=a(9116);let u=(0,a(166).default)(()=>a.e(943).then(a.bind(a,6943)),{loadableGenerated:{webpack:()=>[6943]},ssr:!1}),m=!1;function x(){let[e,t]=(0,s.useState)(!0),[a,m]=(0,s.useState)("first"),[x,f]=(0,s.useState)("7"),[g,h]=(0,s.useState)([]),[y,p]=(0,s.useState)("votes"),[v,j]=(0,s.useState)([]),[b,P]=(0,s.useState)(""),[k,R]=(0,s.useState)([]);(0,s.useEffect)(()=>{h([])},[b]);let M=[{artistId:"1",artistName:"艺人A",category:"男团",data:[{date:"2025-07-18",votes:1e3,rank:5},{date:"2025-07-19",votes:1200,rank:4},{date:"2025-07-20",votes:1500,rank:3},{date:"2025-07-21",votes:1800,rank:2},{date:"2025-07-22",votes:2100,rank:1},{date:"2025-07-23",votes:2400,rank:1},{date:"2025-07-24",votes:2700,rank:1}]},{artistId:"2",artistName:"艺人B",category:"女团",data:[{date:"2025-07-18",votes:800,rank:8},{date:"2025-07-19",votes:950,rank:7},{date:"2025-07-20",votes:1100,rank:6},{date:"2025-07-21",votes:1300,rank:5},{date:"2025-07-22",votes:1600,rank:4},{date:"2025-07-23",votes:1900,rank:3},{date:"2025-07-24",votes:2200,rank:2}]},{artistId:"3",artistName:"艺人C",category:"独唱",data:[{date:"2025-07-18",votes:1200,rank:3},{date:"2025-07-19",votes:1150,rank:5},{date:"2025-07-20",votes:1300,rank:4},{date:"2025-07-21",votes:1250,rank:6},{date:"2025-07-22",votes:1400,rank:5},{date:"2025-07-23",votes:1550,rank:4},{date:"2025-07-24",votes:1700,rank:3}]}];(0,s.useEffect)(()=>{!async function(){t(!0);try{let e=(await (0,d.X5)())[a];if(e){let t=Object.keys(e.categories);R(t),t.length>0&&!b&&P(t[0]);let a=[];Object.values(e.categories).forEach(e=>{a.push(...e)}),a.sort((e,t)=>e.currentVotes===t.currentVotes?e.rankToday-t.rankToday:t.currentVotes-e.currentVotes),j(a),h(a.slice(0,5).map(e=>e.id))}}catch(e){console.error("获取趋势数据失败:",e)}finally{t(!1)}}()},[a,x]);let N=(0,s.useMemo)(()=>{let e=v;return b&&(e=e.filter(e=>e.category===b)),e=e.filter(e=>g.includes(e.id))},[v,b,g]);return e?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,n.jsx)(i.Wo,{title:"正在加载趋势数据...",description:"请稍候"}),(0,n.jsx)("div",{className:"mt-8",children:(0,n.jsx)(i.sT,{})})]})}):(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"趋势分析"}),(0,n.jsxs)("p",{className:"mt-2 text-gray-600",children:["分析艺人投票趋势和排名变化 | 阶段: ","first"===a?"第一阶段":"第二阶段"]})]}),(0,n.jsx)(o.Zb,{className:"mb-6",children:(0,n.jsx)(o.aY,{className:"py-4",children:(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:()=>m("first"),className:(0,c.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","first"===a?"bg-primary-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"第一阶段"}),(0,n.jsx)("button",{onClick:()=>m("second"),className:(0,c.cn)("px-4 py-2 rounded-lg text-sm font-medium transition-colors","second"===a?"bg-primary-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"第二阶段"})]}),(0,n.jsxs)("select",{value:x,onChange:e=>f(e.target.value),className:"select-trigger w-32",children:[(0,n.jsx)("option",{value:"7",children:"近7天"}),(0,n.jsx)("option",{value:"14",children:"近14天"}),(0,n.jsx)("option",{value:"30",children:"近30天"})]}),(0,n.jsxs)("select",{value:y,onChange:e=>p(e.target.value),className:"select-trigger w-32",children:[(0,n.jsx)("option",{value:"votes",children:"票数趋势"}),(0,n.jsx)("option",{value:"rank",children:"排名趋势"})]}),(0,n.jsx)("select",{value:b,onChange:e=>P(e.target.value),className:"select-trigger w-48",children:k.map(e=>(0,n.jsx)("option",{value:e,children:{AM50:"年度男艺人",AM51:"年度女艺人",AM52:"年度男团",AM53:"年度女团",AM54:"最具人气新人-男",AM55:"最具人气新人-女",PR70:"年度歌曲",PR71:"年度专辑",PR72:"年度合作",PR73:"年度MV",PR74:"JMA中国最具影响力华语流行男艺人"}[e]||e},e))})]}),(0,n.jsx)("div",{className:"flex space-x-2",children:(0,n.jsxs)("button",{onClick:()=>{let e=M.filter(e=>g.includes(e.artistId));if(!e.length)return;let t=["日期",...e.map(e=>e.artistName)],a=[];e[0].data.map(e=>e.date).forEach(t=>{let n=[t];e.forEach(e=>{var a;let s=e.data.find(e=>e.date===t);n.push("votes"===y?(null==s?void 0:s.votes.toString())||"0":(null==s?void 0:null===(a=s.rank)||void 0===a?void 0:a.toString())||"0")}),a.push(n)});let n=new Blob([[t.join(","),...a.map(e=>e.join(","))].join("\n")],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),r=URL.createObjectURL(n);s.setAttribute("href",r),s.setAttribute("download","趋势数据_".concat((0,c.p6)(new Date),".csv")),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)},className:"btn btn-outline flex items-center space-x-2",children:[(0,n.jsx)(r.Z,{className:"w-4 h-4"}),(0,n.jsx)("span",{children:"导出"})]})})]})})}),(0,n.jsxs)(o.Zb,{className:"mb-6",children:[(0,n.jsx)(o.Ol,{children:(0,n.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,n.jsx)(l,{className:"w-5 h-5"}),"选择对比艺人 (最多5位)",b&&(0,n.jsxs)("span",{className:"text-sm font-normal text-gray-500",children:["- ",{AM50:"年度男艺人",AM51:"年度女艺人",AM52:"年度男团",AM53:"年度女团",AM54:"最具人气新人-男",AM55:"最具人气新人-女",PR70:"年度歌曲",PR71:"年度专辑",PR72:"年度合作",PR73:"年度MV",PR74:"JMA中国最具影响力华语流行男艺人"}[b]||b,(0,n.jsxs)("span",{className:"text-xs text-gray-400 ml-2",children:["(共 ",v.filter(e=>e.category===b).length," 位艺人)"]})]})]})}),(0,n.jsx)(o.aY,{children:(0,n.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 max-h-96 overflow-y-auto",children:v.filter(e=>b&&e.category===b).map(e=>(0,n.jsxs)("label",{className:"flex items-center space-x-3 p-3 rounded-lg border hover:bg-gray-50 cursor-pointer transition-colors",children:[(0,n.jsx)("input",{type:"checkbox",checked:g.includes(e.id),onChange:t=>{t.target.checked?g.length<5&&h([...g,e.id]):h(g.filter(t=>t!==e.id))},className:"h-4 w-4 text-primary-600 rounded flex-shrink-0"}),(0,n.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[e.imageUrl&&(0,n.jsx)("img",{src:e.imageUrl,alt:e.name,className:"w-8 h-8 rounded-full object-cover border border-gray-200",onError:e=>{e.target.style.display="none"}}),(0,n.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,n.jsxs)("div",{className:"font-medium truncate",children:[e.name,e.nameOfWork&&["PR70","PR71","PR72","PR73"].includes(e.category)&&(0,n.jsxs)("span",{className:"text-xs text-blue-600 ml-1",children:["(",e.nameOfWork,")"]})]}),(0,n.jsxs)("div",{className:"text-sm text-gray-500",children:["#",e.rankToday," \xb7 ",(0,c.uf)(e.currentVotes)," 票"]}),(0,n.jsx)("div",{className:"text-xs text-gray-400",children:{AM50:"年度男艺人",AM51:"年度女艺人",AM52:"年度男团",AM53:"年度女团",AM54:"最具人气新人-男",AM55:"最具人气新人-女",PR70:"年度歌曲",PR71:"年度专辑",PR72:"年度合作",PR73:"年度MV",PR74:"JMA中国最具影响力华语流行男艺人"}[e.category]||e.category})]})]})]},e.id))})})]}),(0,n.jsxs)(o.Zb,{children:[(0,n.jsxs)(o.Ol,{children:[(0,n.jsxs)(o.ll,{className:"flex items-center gap-2",children:["votes"===y?"投票数据对比":"排名数据对比",b&&(0,n.jsxs)("span",{className:"text-sm font-normal text-gray-500",children:["- ",{AM50:"年度男艺人",AM51:"年度女艺人",AM52:"年度男团",AM53:"年度女团",AM54:"最具人气新人-男",AM55:"最具人气新人-女",PR70:"年度歌曲",PR71:"年度专辑",PR72:"年度合作",PR73:"年度MV",PR74:"JMA中国最具影响力华语流行男艺人"}[b]||b]})]}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"注：当前显示的是最新数据快照，历史趋势功能需要积累多日数据后开放"})]}),(0,n.jsx)(o.aY,{children:g.length>0&&N.length>0?(0,n.jsx)("div",{className:"chart-container",children:(0,n.jsx)(u,{option:(()=>{let e=(0,c.LP)(N.length);return"votes"===y?{title:{text:"投票趋势分析（当前数据快照）",left:"center"},tooltip:{trigger:"axis",formatter:e=>{let t="<div>当前快照</div>";return e.forEach((e,a)=>{t+='<div style="color:'.concat(e.color,'">\n                ').concat(e.seriesName,": ").concat(e.value.toLocaleString()," 票\n              </div>")}),t}},legend:{data:N.map(e=>e.nameOfWork&&["PR70","PR71","PR72","PR73"].includes(e.category)?"".concat(e.name," (").concat(e.nameOfWork,")"):e.name),bottom:10},xAxis:{type:"category",data:["当前排名"]},yAxis:{type:"value",name:"票数",axisLabel:{formatter:e=>e.toLocaleString()}},series:N.map((t,a)=>({name:t.nameOfWork&&["PR70","PR71","PR72","PR73"].includes(t.category)?"".concat(t.name," (").concat(t.nameOfWork,")"):t.name,type:"bar",data:[t.currentVotes],itemStyle:{color:e[a]}}))}:{title:{text:"排名对比分析（当前数据快照）",left:"center"},tooltip:{trigger:"axis",formatter:e=>{let t="<div>当前排名</div>";return e.forEach((e,a)=>{t+='<div style="color:'.concat(e.color,'">\n                ').concat(e.seriesName,": 第 ").concat(e.value," 名\n              </div>")}),t}},legend:{data:N.map(e=>e.nameOfWork&&["PR70","PR71","PR72","PR73"].includes(e.category)?"".concat(e.name," (").concat(e.nameOfWork,")"):e.name),bottom:10},xAxis:{type:"category",data:["当前排名"]},yAxis:{type:"value",name:"排名",inverse:!0,min:1,axisLabel:{formatter:e=>"第".concat(e,"名")}},series:N.map((t,a)=>({name:t.nameOfWork&&["PR70","PR71","PR72","PR73"].includes(t.category)?"".concat(t.name," (").concat(t.nameOfWork,")"):t.name,type:"bar",data:[t.rankToday],itemStyle:{color:e[a]}}))}})(),style:{height:"400px",width:"100%"},notMerge:!0,lazyUpdate:!0})}):(0,n.jsx)("div",{className:"py-12 text-center text-gray-500",children:0===g.length?"请选择要分析的艺人":b?'当前分类"'.concat({AM50:"年度男艺人",AM51:"年度女艺人",AM52:"年度男团",AM53:"年度女团",AM54:"最具人气新人-男",AM55:"最具人气新人-女",PR70:"年度歌曲",PR71:"年度专辑",PR72:"年度合作",PR73:"年度MV",PR74:"JMA中国最具影响力华语流行男艺人"}[b]||b,'"中没有选中的艺人'):"请选择要分析的艺人"})})]})]})})}},2735:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});let n=(0,a(9763).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},166:function(e,t,a){"use strict";a.d(t,{default:function(){return s.a}});var n=a(5775),s=a.n(n)},5775:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}});let n=a(7043);a(7437),a(2265);let s=n._(a(5602));function r(e,t){var a;let n={loading:e=>{let{error:t,isLoading:a,pastDelay:n}=e;return null}};"function"==typeof e&&(n.loader=e);let r={...n,...t};return(0,s.default)({...r,modules:null==(a=r.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},1523:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let n=a(8993);function s(e){let{reason:t,children:a}=e;if("undefined"==typeof window)throw new n.BailoutToCSRError(t);return a}},5602:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let n=a(7437),s=a(2265),r=a(1523),l=a(49);function o(e){return{default:e&&"default"in e?e.default:e}}let i={loader:()=>Promise.resolve(o(()=>null)),loading:null,ssr:!0},c=function(e){let t={...i,...e},a=(0,s.lazy)(()=>t.loader().then(o)),c=t.loading;function d(e){let o=c?(0,n.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,i=t.ssr?(0,n.jsxs)(n.Fragment,{children:["undefined"==typeof window?(0,n.jsx)(l.PreloadCss,{moduleIds:t.modules}):null,(0,n.jsx)(a,{...e})]}):(0,n.jsx)(r.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(a,{...e})});return(0,n.jsx)(s.Suspense,{fallback:o,children:i})}return d.displayName="LoadableComponent",d}},49:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return r}});let n=a(7437),s=a(544);function r(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let a=(0,s.getExpectedRequestStore)("next/dynamic css"),r=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files.filter(e=>e.endsWith(".css"));r.push(...t)}}return 0===r.length?null:(0,n.jsx)(n.Fragment,{children:r.map(e=>(0,n.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}},function(e){e.O(0,[368,86,971,117,744],function(){return e(e.s=2769)}),_N_E=e.O()}]);