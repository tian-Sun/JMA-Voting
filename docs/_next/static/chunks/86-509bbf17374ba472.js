(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86],{6070:function(t,e,n){"use strict";n.d(e,{Ol:function(){return c},Zb:function(){return o},aY:function(){return s},ll:function(){return i}});var r=n(7437),a=n(4508);function o(t){let{className:e,children:n,hover:o=!1}=t;return(0,r.jsx)("div",{className:(0,a.cn)("rounded-lg border border-gray-200 bg-white shadow-sm",o&&"transition-shadow hover:shadow-md",e),children:n})}function c(t){let{className:e,children:n,border:o=!1}=t;return(0,r.jsx)("div",{className:(0,a.cn)("p-6",o&&"border-b border-gray-200",e),children:n})}function i(t){let{className:e,children:n}=t;return(0,r.jsx)("h3",{className:(0,a.cn)("text-lg font-semibold text-gray-900",e),children:n})}function s(t){let{className:e,children:n}=t;return(0,r.jsx)("div",{className:(0,a.cn)("p-6 pt-0",e),children:n})}},492:function(t,e,n){"use strict";n.d(e,{Jr:function(){return i},Wo:function(){return c},sT:function(){return s}});var r=n(7437),a=n(4508);function o(t){let{className:e,size:n="md"}=t;return(0,r.jsx)("div",{className:(0,a.cn)("animate-spin rounded-full border-2 border-gray-300 border-t-primary-600",{sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"}[n],e)})}function c(t){let{title:e="加载中...",description:n}=t;return(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,r.jsx)(o,{}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:e}),n&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:n})]})]})})}function i(t){let{columns:e,rows:n}=t;return(0,r.jsx)("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 rounded-lg",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-300",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsx)("tr",{children:Array.from({length:e}).map((t,e)=>(0,r.jsx)("th",{className:"px-6 py-3 text-left",children:(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse"})},e))})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.from({length:n}).map((t,n)=>(0,r.jsx)("tr",{children:Array.from({length:e}).map((t,e)=>(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsx)("div",{className:"h-4 bg-gray-100 rounded animate-pulse"})},e))},n))})]})})}function s(){return(0,r.jsx)("div",{className:"w-full h-96 bg-gray-50 rounded-lg border border-gray-200 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(o,{size:"lg"}),(0,r.jsx)("p",{className:"mt-3 text-sm text-gray-500",children:"正在加载图表数据..."})]})})}},9116:function(t,e,n){"use strict";n.d(e,{Iu:function(){return i},X5:function(){return h},XJ:function(){return c},_h:function(){return o},j5:function(){return s}});let r=n(7580).env.API_BASE_URL||"https://lite-be.cfanfever.com/api/v1/fanfever",a=[{id:1,code:"AM50",name:"Male Artiste of the Year",category:"AM50"},{id:2,code:"AM51",name:"Female Artiste of the Year",category:"AM51"},{id:3,code:"AM52",name:"Male Group of the Year",category:"AM52"},{id:4,code:"AM53",name:"Female Group of the Year",category:"AM53"},{id:5,code:"AM54",name:"Hottest Trending Rookie - Male",category:"AM54"},{id:6,code:"AM55",name:"Hottest Trending Rookie - Female",category:"AM55"},{id:7,code:"PR70",name:"Song of the Year",category:"PR70"},{id:8,code:"PR71",name:"Album of the Year",category:"PR71"},{id:9,code:"PR72",name:"Collaboration of the Year",category:"PR72"},{id:10,code:"PR73",name:"Music Video of the Year",category:"PR73"},{id:11,code:"PR74",name:"JMA China - Most Influential Manopop Artiste",category:"PR74"}];async function o(t){try{console.log("尝试加载本地数据...");let e=await l(t);if(e)return console.log("使用本地数据"),e}catch(t){console.log("本地数据加载失败，尝试API调用:",t)}try{console.log("尝试API调用...");let e=await u(t);if(e)return e}catch(t){console.log("API调用失败:",t)}return console.log("使用备用数据"),f(t)}async function c(t){try{console.log("获取热度分析数据...");try{console.log("尝试从API获取实时数据...");let e=await o(t);if(e)return console.log("使用API数据生成热度分析"),function(t,e){let n=[],r=[];return Object.entries(t.categories).forEach(e=>{let[o,c]=e,i=c.reduce((t,e)=>t+e.currentVotes,0),s=c.slice().sort((t,e)=>e.currentVotes-t.currentVotes),l=s.slice(0,10).reduce((t,e)=>t+e.currentVotes,0),u=s.slice(0,3).reduce((t,e)=>t+e.currentVotes,0),d=i/c.length,f=c.reduce((t,e)=>t+Math.pow(e.currentVotes-d,2),0)/c.length,h=0;d>0&&f>0&&(isNaN(h=Math.min(100,Math.sqrt(f)/d*100))||!isFinite(h))&&(h=0);let g=a.find(t=>t.category===o);n.push({category:o,categoryName:(null==g?void 0:g.name)||o,totalVotes:i,topTenVotes:l,topTenRatio:i>0?l/i*100:0,dailyGrowth:0,averageVotesPerCandidate:d,topThreeVotes:u,competitionIntensity:h,lastUpdated:t.snapshot_date}),s.slice(15,50).filter(t=>t.currentVotes>1.2*d).slice(0,3).forEach(t=>{let e=t.rankToday||s.findIndex(e=>e.id===t.id)+1,n=t.currentVotes||0;r.push({artistId:t.id,artistName:t.name,englishName:t.englishName||"",category:o,categoryName:(null==g?void 0:g.name)||o,currentRank:e,previousRank:e+Math.floor(10*Math.random())+5,rankChange:Math.floor(10*Math.random())+5,currentVotes:n,previousVotes:Math.floor((n||0)*(.6+.3*Math.random())),voteGrowth:50+100*Math.random(),voteGrowthAbsolute:Math.floor(.4*(n||0)),imageUrl:t.imageUrl||"",talentNumber:t.talentNumber||"",nameOfWork:t.nameOfWork||null})})}),{date:t.snapshot_date,stage:e,categoryHeats:n,darkHorses:r.slice(0,10),totalVotes:t.total_votes||0,totalCandidates:Object.values(t.categories).reduce((t,e)=>t+e.length,0),collection_time:new Date().toISOString()}}(e,t)}catch(t){console.log("API数据获取失败，尝试本地文件:",t)}let e=new Date().toISOString().split("T")[0],r="heat_".concat(e,"_").concat(t,".json.gz"),c=await fetch("/data/".concat(r));if(!c.ok)throw Error("热度分析文件不存在: ".concat(r));let i=await c.arrayBuffer(),s=new Uint8Array(i),l=(await n.e(125).then(n.bind(n,3425))).inflate(s,{to:"string"}),u=JSON.parse(l);return console.log("使用本地热度分析文件"),u}catch(t){return console.warn("所有数据源失败:",t),null}}async function i(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7,r=[];for(let a=0;a<e;a++){let e=new Date;e.setDate(e.getDate()-a);let o=e.toISOString().split("T")[0];try{let e="heat_".concat(o,"_").concat(t,".json.gz"),a=await fetch("/data/".concat(e));if(a.ok){let t=await a.arrayBuffer(),e=new Uint8Array(t),o=(await n.e(125).then(n.bind(n,3425))).inflate(e,{to:"string"}),c=JSON.parse(o);r.push(c)}}catch(t){console.warn("加载 ".concat(o," 热度数据失败:"),t)}}return r.sort((t,e)=>t.date.localeCompare(e.date))}async function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7,n=await i(t,e);if(n.length<1)return console.log("暂无任何历史数据"),{dates:[],categories:[],trendsData:{}};let r=n.map(t=>t.date.slice(5)),a=n[0].categoryHeats.map(t=>t.category),o={};return a.forEach(t=>{let e=n[0].categoryHeats.find(e=>e.category===t);e&&(o[t]={categoryName:e.categoryName,totalVotes:[],dailyGrowth:[],competitionIntensity:[],averageVotes:[],topTenRatio:[]})}),n.forEach(t=>{t.categoryHeats.forEach(t=>{o[t.category]&&(o[t.category].totalVotes.push(t.totalVotes),o[t.category].dailyGrowth.push(t.dailyGrowth),o[t.category].competitionIntensity.push(t.competitionIntensity||0),o[t.category].averageVotes.push(t.averageVotesPerCandidate),o[t.category].topTenRatio.push(t.topTenRatio))})}),{dates:r,categories:a,trendsData:o}}async function l(t){try{let e=new Date().toISOString().split("T")[0],r="".concat(e,"_").concat(t,".json.gz"),a=await fetch("/data/".concat(r));if(!a.ok)throw Error("本地文件不存在: ".concat(r));let o=await a.arrayBuffer(),c=new Uint8Array(o),i=(await n.e(125).then(n.bind(n,3425))).inflate(c,{to:"string"});return JSON.parse(i)}catch(t){return console.warn("加载本地数据失败:",t),null}}async function u(t){console.log("开始从API获取所有榜单的 ".concat(t," 阶段数据..."));let e=a.map(e=>d(e.id,t)),n=(await Promise.allSettled(e)).filter(t=>"fulfilled"===t.status&&null!==t.value).map(t=>t.value);return 0===n.length?(console.warn("所有榜单数据获取失败，将使用备用数据"),null):(console.log("成功获取 ".concat(n.length,"/").concat(a.length," 个榜单数据")),function(t,e){let n=new Date().toISOString().split("T")[0],r=0,a={};return t.forEach(t=>{let{listConfig:e,data:n}=t;r+=n.total_votes||0;let o=n.data.map((t,n)=>({id:"".concat(e.category,"-").concat(t.talent_number||n),name:t.talent.artiste_nominated,englishName:t.talent.english_name,currentVotes:t.votes,rankToday:t.rank,rankDelta:0,category:e.category,talentNumber:t.talent_number,imageUrl:t.talent.image_url,nameOfWork:t.talent.name_of_work}));a[e.category]=o}),{snapshot_date:n,stage:e,total_votes:r,categories:a}}(n,t))}async function d(t,e){try{let n=a.find(e=>e.id===t);if(!n)return console.warn("未找到榜单配置，ID: ".concat(t)),null;console.log("获取榜单: ".concat(n.name," (").concat(n.code,")"));let o=await fetch("".concat(r,"/voteResult/").concat(t,"?type=").concat(e),{method:"GET",headers:{Accept:"application/json"},cache:"no-cache",mode:"cors"});if(!o.ok)throw Error("HTTP ".concat(o.status,": ").concat(o.statusText));let c=await o.json();return console.log("".concat(n.code," 数据获取成功，总票数:"),c.total_votes),{listConfig:n,data:c}}catch(e){return console.error("获取榜单 ".concat(t," 数据失败:"),e),null}}function f(t){console.log("生成备用示例数据...");let e=new Date().toISOString().split("T")[0],n={},r=0;return a.forEach(t=>{let e=[],a=t.code.startsWith("AM")?75:50;for(let n=1;n<=a;n++){let a=Math.floor(1e5*Math.random())+1e4;r+=a,e.push({id:"".concat(t.category,"-").concat(n),name:"".concat(t.code," 候选人 ").concat(n),englishName:"".concat(t.code," Candidate ").concat(n),currentVotes:a,rankToday:n,rankDelta:Math.floor(11*Math.random())-5,category:t.category,talentNumber:"".concat(t.code.slice(0,2)," ").concat(n.toString().padStart(2,"0")),imageUrl:"https://picsum.photos/200/200?random=".concat(n+100*t.id),nameOfWork:t.code.startsWith("PR")?"作品 ".concat(n):null})}n[t.category]=e}),{snapshot_date:e,stage:t,total_votes:r,categories:n}}async function h(){try{let t=await o("first"),e=await o("second");return{first:t||f("first"),second:e||f("second")}}catch(t){return console.error("获取多阶段数据失败:",t),{first:f("first"),second:f("second")}}}},4508:function(t,e,n){"use strict";n.d(e,{JQ:function(){return u},LP:function(){return d},cn:function(){return i},p6:function(){return l},uf:function(){return s}});var r=n(1994),a=n(3335),o=n(8082),c=n(7371);function i(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,a.m6)((0,r.W)(e))}function s(t){return t.toLocaleString("zh-CN")}function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd",n="string"==typeof t?(0,o.Z)(t):t;return(0,c.Z)(n,e)}function u(t){return t>0?{text:"↑".concat(t),className:"text-green-600 bg-green-50",icon:"↑"}:t<0?{text:"↓".concat(Math.abs(t)),className:"text-red-600 bg-red-50",icon:"↓"}:{text:"—",className:"text-gray-500 bg-gray-50",icon:"—"}}function d(t){let e=["#ef4444","#f97316","#f59e0b","#eab308","#84cc16","#22c55e","#10b981","#14b8a6","#06b6d4","#0ea5e9","#3b82f6","#6366f1","#8b5cf6","#a855f7","#d946ef","#ec4899","#f43f5e"];if(t<=e.length)return e.slice(0,t);let n=[...e];for(;n.length<t;)n.push("hsl(".concat(360*Math.random(),", 70%, 50%)"));return n.slice(0,t)}},7580:function(t){var e,n,r,a=t.exports={};function o(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function i(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{n="function"==typeof clearTimeout?clearTimeout:c}catch(t){n=c}}();var s=[],l=!1,u=-1;function d(){l&&r&&(l=!1,r.length?s=r.concat(s):u=-1,s.length&&f())}function f(){if(!l){var t=i(d);l=!0;for(var e=s.length;e;){for(r=s,s=[];++u<e;)r&&r[u].run();u=-1,e=s.length}r=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===c||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function g(){}a.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new h(t,e)),1!==s.length||l||i(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(t){return[]},a.binding=function(t){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}}]);